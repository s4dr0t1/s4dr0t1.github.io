---

title: Digital Certificates
id: digital_certificates

---

> Digital Signatures: What they are, how do they work and why are they important.


## What is what?

### Basics

Digital Certificates acts like a credential, unique in nature, and is used to make sure the supposedly public key of the person we're encrypting our data with, is of course associated with that person we want to send the data to viz. it attests the binding of an entity to a public key.

Making sure that we encrypt with the public key of the intended person is important from a security perspective, otherwise we may end up encrypting our data with a bogus key (unintentionally) and it can be leveraged by an adversary.

One of the most common formats of Digital Certificates we see is `X.509`, but there are more out there, such as a PGP certificate.

### X.509 Certificates

![Skeleton of a X.509 certificate](/img/docs/crypto/applications/certificate_format.png)

It contains a lot of information, such as:
- The version of the X.509 standard used
- The serial number of the certificate, which acts as a unique identifier
- Information about the entity, such as Name, Email, Organisation etc
- Validity period stating when the certificate will expire
- The Digital Signature, generated by a trusted entity


## How?

### How Are Certificates Requested& Initialised

In this case, Certificate Authority is the **trusted entity** we speak of, or someone designated by the Certificate Authority. They do the work of issuing, verifying and validating Digital Certificates

To obtain a X.509 certificate, we must request a certificate from a CA, by providing all the requisite information and digitally sign the package with our private key. The CA does background checks and information verification to make sure whatever we have mentioned is correct. After all these checks and stuff, we finally get issued a Digital Certificate.

Since the CA can't verify and sign certificates for everyone, because there is a big overhead that comes when verifying the information provided, there is a generally distributed architecture followed throughout. One or more CAs form a central ring, and issue certificates to entities, and they in turn, can validate and issue certificates inside their organisation and the issued child's certificates would derive the trust from the root certificate.

### How are Digital Signatures Leveraged?

:::note
There are mainly three components of a Digital Certificate: The Public Key, The Digital Signature and information (name and stuff)
:::

![How Are Digital Signatures Leveraged](/img/docs/crypto/applications/signature_leverage.png)

Digital Certificates has a lot of components, one of which is a Digital Signature. It's generated by hashing the public key of the entity, and encrypting it with the private key by an a very trusted person we believe will do its best to verify the identity of the entity, so that we don't have to. The concept of Mutual Trust is established, If X is a very trusted entity, and X trusts Y, I trust X very much, and consequently I'd also trust Y.
It doesn't attest to all the information mentioned in the Digital Certificate as a whole, just the Public Key of the individual involved.

### Verification Of Digital Signatures

![Verification Of Digital Signatures](/img/docs/crypto/applications/signatures_verification.png)

To verify if the Public Key mentioned in the Digital Certificate has been verified and vetted, by the Certificate Authority, we hash it and compare it with the hash we get by decrypting the Digital Signature with the help of CA's public key. If they come out to be same, it means we can trust that particular public key, if they don't come out to be same, it should immediately raise red flags (Man-in-the-middle attack)

### Certificate Distribution and Storage

There's always the option of doing all of it manually, but it doesn't scale at all and is very unfeasible for two parties who've never even met.

There are Certificate Servers which are used for the storage and distribution of Digital Certificates, and there is a more advanced form of the same, Public Key Infrastructure, which is a hierarchy of many systems working together to provide key management features (such as certificate initialisation, storage, management, establishing trust etc), and not just storage and distribution.

### Certificate Expiration

- Once a certificate expires (the validity is mentioned there in the Digital Certificate), a new certificate can be requested again from the **Trusted Entity**.
- The lives of these certificates is intentionally kept short, as a workaround for private key compromise. If a private key gets compromised, anyone with it can decrypt the data being sent to it.
- If a certificate is expired, the people this certificate is being sent to, can understand the fact that this certificate is not valid anymore, and any data shouldn't be encrypted with this Public Key.

### Certificate Revocation

There are times when a certificate needs to be revoked viz. it doesn't hold any value and the public key shouldn't be trusted because of several reasons such as Unexpected Private Key Compromise, The Entity is not there anymore (job change, fired etc), or some information has been changed pertaining to the employee. Anybody who has signed a certificate, can revoke his signature on the certificate

If a Certificate has been revoked, there should be a well-established system in place to let the sender know about this revocation, and there are, actually, such as: Certificate Revocation Lists (CRL) and OCSP (Online Status Certificate Protocol)


#### Certificate Revocation List

![Certificate Revocation Lists](/img/docs/crypto/applications/crl.png)

In this case, a list of revoked certificates is maintained and curated by the Certificate Authority (CA). To check if the Certificate has been revoked or not, we must contact the CA, and download the CRL, look through the big list for the name of our sender to check whether the certificate has been revoked or not.

This method is very resource intensive because the CA would have to deal with a lot of traffic seeking the CRL and has some other limitations too:
- The CRL needs to be downloaded each time its updated
- There is no realtime notificatio service, and we need to do this process manually to keep a checked on the revoked certificates. And it might be sometimes, too late.


#### OCSP (Online Certificate Status Protocol)

![Online Certificate Status Protocol](/img/docs/crypto/applications/ocsp_stapling.png)

OCSP is designed to overcome the limitations of CRL. We can request the status of a certificate anytime by just using the serial number of the certificate.
Every time we want to set up a connection, the other person sends the digital certificate which has the public key. We can verify the revocation status, by querying the OCSP server by using the serial number, instead of downloading CRL. The OCSP responder checks the status and responds to the request

#### OCSP Stapling (Online Certificate Status Protocol with Stapling)

![Online Certificate Status Protocol with stapling](/img/docs/crypto/applications/ocsp_stapling.png)

In case of normal OCSP, the responder will have to deal with a huge amount of requests and also, if the client is unable to connect to the OCSP server, there could be many outcomes, both of which are undesirable.
- Continue anyway by trusting the Public Key, even through the certificate might be revoked (or not) which defeats the entire purpose of certificate checking 
- Terminate

Instead of the client contacting the OCSP responders, this time the web server does that part, and keeps a digitally signed response of the same and whenever, during the SSL handshake process, it's sending a digital certificate, it also sends the signed approval along with it, so that the client can rest assured and not contact the responder about the certificate.

